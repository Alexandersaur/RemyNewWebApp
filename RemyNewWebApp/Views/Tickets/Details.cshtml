@model RemyNewWebApp.Models.Ticket
@using RemyNewWebApp.Services.Interfaces
@using Microsoft.AspNetCore.Identity
@inject UserManager<BTUser> UserManager
@inject IBTFileService BTFileService
@inject IBTProjectService BTProjectSerivce
@inject IBTTicketService BTTicketService

@{
    //int companyId = User.Identity.GetCompanyId();
    //BTUser developer = await BTTicketService.GetTicketDeveloperAsync(Model.Id, companyId);
    BTUser btUser = await UserManager.GetUserAsync(User);
    BTUser projectManager = await BTProjectSerivce.GetProjectManagerAsync(Model.ProjectId);
}

@*
    style="background-color: #F7D9E3"
    style="background-color: #CBF0F4"
    style="background-color: #CBD4F4"
    style="background-color: #F4EBCB"
*@

<!--begin::Content-->
<div class="content d-flex flex-column flex-column-fluid" id="kt_content">
    <!--begin::Container-->
    <div class="container" id="kt_content_container">
        <!--begin::Navbar-->
        <div class="card mb-5 mb-xxl-8">
            <div class="card-body pb-0">
                <!--begin::Details-->
                <div class="d-flex flex-wrap flex-sm-nowrap mb-3">
                    <!--begin: Pic-->
                    <div class="me-7 mb-4">
                        <div class="symbol symbol-100px symbol-lg-160px symbol-fixed position-relative">
                            @if (Model.OwnerUser != null)
                            {
                                @if (Model.OwnerUser.AvatarFileData != null)
                                {
                                    <img src="data:image/*;base64,@Convert.ToBase64String(Model.OwnerUser.AvatarFileData)" />
                                }
                                else
                                {
                                    <img src="/assets/media/avatars/150-26.jpg" alt="image" title="Change Default" />
                                }
                            }
                            else
                            {
                                <img src="/assets/media/avatars/150-26.jpg" alt="image" title="Change Default" />
                            }
                            <div class="position-absolute translate-middle bottom-0 start-100 mb-6 bg-primary rounded-circle border border-4 border-white h-20px w-20px"></div>
                        </div>
                    </div>
                    <!--end::Pic-->
                    <!--begin::Info-->
                    <div class="flex-grow-1">
                        <!--begin::Title-->
                        <div class="d-flex justify-content-between align-items-start flex-wrap mb-2">
                            <!--begin::User-->
                            <div class="d-flex flex-column">
                                <!--begin::Name-->
                                <div class="d-flex align-items-center mb-2">
                                        <!--begin::Svg Icon | path: assets/media/icons/duotune/arrows/arr069.svg-->
                                        <span class="svg-icon svg-icon-primary svg-icon-2hx me-2">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                                                <path d="M14.4 11H2.99999C2.39999 11 1.99999 11.4 1.99999 12C1.99999 12.6 2.39999 13 2.99999 13H14.4V11Z" fill="black" />
                                                <path d="M17.7762 13.2561C18.4572 12.5572 18.4572 11.4429 17.7762 10.7439L13.623 6.48107C13.1221 5.96697 12.25 6.32158 12.25 7.03934V16.9607C12.25 17.6785 13.1221 18.0331 13.623 17.519L17.7762 13.2561Z" fill="black" />
                                                <rect opacity="0.5" width="2" height="16" rx="1" transform="matrix(-1 0 0 1 22 4)" fill="black" />
                                            </svg>
                                        </span>                        
                                        <!--end::Svg Icon-->
                                    <a class="text-gray-600 text-hover-primary fs-4 fw-light me-1" asp-action="Details" asp-controller="Projects" asp-route-id="@Model.Project.Id">PROJECT: @Model.Project.Name</a>
                                </div>
                                <div class="d-flex align-items-center mb-0">
                                    <a class="text-gray-900 text-hover-primary fs-2 fw-bolder me-1">
                                        @Model.Title : Submitted by @if (Model.OwnerUser != null)
                                        {@Model.OwnerUser.FullName}
                                    </a>
                                </div>
                                <!--end::Name-->
                                <!--begin::Info-->
                                <div class="d-flex flex-wrap fw-bold fs-6 mb-4 pe-2">
                                    <a class="d-flex align-items-center text-gray-400 text-hover-primary me-5 mb-2">
                                        <div class="text-muted">
                                            @Model.Description
                                        </div>
                                    </a>
                                </div>
                                <!--end::Info-->
                            </div>
                            <!--end::User-->
                        </div>
                        <!--end::Title-->
                        <!--begin::Stats-->
                        <div class="d-flex flex-wrap flex-stack">
                            <!--begin::Wrapper-->
                            <div class="d-flex flex-column flex-grow-1 pe-8">
                                <!--begin::Stats-->
                                <div class="d-flex flex-wrap">
                                    <!--begin::Users-->
                                    <a asp-action="Edit" asp-route-id="@Model.Id">
                                        <div class="d-flex align-items-center ms-2 border border-gray-300 border-dashed rounded min-w-100px py-3 px-4 me-3 mb-3" style="background-color:white">
                                            <!--begin::Title-->
                                            <div class="justify-content-center">
                                                <div class="fs-2 fw-bolder">EDIT</div>
                                                <div class="fw-light fs-6">Ticket Info</div>
                                            </div>
                                            <!--end::Title-->
                                        </div>
                                    </a>
                                    <!--end::Users-->
                                    <!--begin::Comments-->
                                    <div class="d-flex align-items-center ms-2 border border-gray-300 border-dashed rounded min-w-100px py-3 px-4 me-3 mb-3">
                                        <!--begin::Symbol-->
                                        <div class="symbol symbol-40px me-3">
                                            <div class="symbol-label bg-primary bg-opacity-10">
                                                <!--begin::Svg Icon | path: icons/duotune/abstract/abs045.svg-->
                                                <span class="svg-icon svg-icon-1 svg-icon-primary">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                                                        <path opacity="0.3" d="M8 8C8 7.4 8.4 7 9 7H16V3C16 2.4 15.6 2 15 2H3C2.4 2 2 2.4 2 3V13C2 13.6 2.4 14 3 14H5V16.1C5 16.8 5.79999 17.1 6.29999 16.6L8 14.9V8Z" fill="black" />
                                                        <path d="M22 8V18C22 18.6 21.6 19 21 19H19V21.1C19 21.8 18.2 22.1 17.7 21.6L15 18.9H9C8.4 18.9 8 18.5 8 17.9V7.90002C8 7.30002 8.4 6.90002 9 6.90002H21C21.6 7.00002 22 7.4 22 8ZM19 11C19 10.4 18.6 10 18 10H12C11.4 10 11 10.4 11 11C11 11.6 11.4 12 12 12H18C18.6 12 19 11.6 19 11ZM17 15C17 14.4 16.6 14 16 14H12C11.4 14 11 14.4 11 15C11 15.6 11.4 16 12 16H16C16.6 16 17 15.6 17 15Z" fill="black" />
                                                    </svg>
                                                </span>
                                                <!--end::Svg Icon-->
                                            </div>
                                        </div>
                                        <!--end::Symbol-->
                                        <!--begin::Title-->
                                        <div>
                                            <div class="fs-2 fw-bolder" data-kt-countup="true" data-kt-countup-value="@Model.Comments.ToList().Count()">0</div>
                                            <div class="fw-bold fs-6">Notes</div>
                                        </div>
                                        <!--end::Title-->
                                    </div>
                                    <!--end::Comments-->
                                    <!--begin::Attachments-->
                                    <div class="d-flex align-items-center ms-2 border border-gray-300 border-dashed rounded min-w-100px py-3 px-4 me-3 mb-3">
                                        <!--begin::Symbol-->
                                        <div class="symbol symbol-40px me-3">
                                            <div class="symbol-label bg-primary bg-opacity-10">
                                                <!--begin::Svg Icon | path: icons/duotune/abstract/abs045.svg-->
                                                <span class="svg-icon svg-icon-1 svg-icon-primary">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                                                        <path opacity="0.3" d="M4.425 20.525C2.525 18.625 2.525 15.525 4.425 13.525L14.825 3.125C16.325 1.625 18.825 1.625 20.425 3.125C20.825 3.525 20.825 4.12502 20.425 4.52502C20.025 4.92502 19.425 4.92502 19.025 4.52502C18.225 3.72502 17.025 3.72502 16.225 4.52502L5.82499 14.925C4.62499 16.125 4.62499 17.925 5.82499 19.125C7.02499 20.325 8.82501 20.325 10.025 19.125L18.425 10.725C18.825 10.325 19.425 10.325 19.825 10.725C20.225 11.125 20.225 11.725 19.825 12.125L11.425 20.525C9.525 22.425 6.425 22.425 4.425 20.525Z" fill="black" />
                                                        <path d="M9.32499 15.625C8.12499 14.425 8.12499 12.625 9.32499 11.425L14.225 6.52498C14.625 6.12498 15.225 6.12498 15.625 6.52498C16.025 6.92498 16.025 7.525 15.625 7.925L10.725 12.8249C10.325 13.2249 10.325 13.8249 10.725 14.2249C11.125 14.6249 11.725 14.6249 12.125 14.2249L19.125 7.22493C19.525 6.82493 19.725 6.425 19.725 5.925C19.725 5.325 19.525 4.825 19.125 4.425C18.725 4.025 18.725 3.42498 19.125 3.02498C19.525 2.62498 20.125 2.62498 20.525 3.02498C21.325 3.82498 21.725 4.825 21.725 5.925C21.725 6.925 21.325 7.82498 20.525 8.52498L13.525 15.525C12.325 16.725 10.525 16.725 9.32499 15.625Z" fill="black" />
                                                    </svg>
                                                </span>
                                                <!--end::Svg Icon-->
                                            </div>
                                        </div>
                                        <!--end::Symbol-->
                                        <!--begin::Title-->
                                        <div>
                                            <div class="fs-2 fw-bolder" data-kt-countup="true" data-kt-countup-value="@Model.Attachments.ToList().Count()">0</div>
                                            <div class="fw-bold fs-6" >Files</div>
                                        </div>
                                        <!--end::Title-->
                                    </div>
                                    <!--end::Attachments-->
                                    <!--begin::History-->
                                    <div class="d-flex align-items-center ms-2 border border-gray-300 border-dashed rounded min-w-100px py-3 px-4 me-3 mb-3">
                                        <!--begin::Symbol-->
                                        <div class="symbol symbol-40px me-3">
                                            <div class="symbol-label bg-primary bg-opacity-10">
                                                <!--begin::Svg Icon | path: icons/duotune/abstract/abs045.svg-->
                                                <!--begin::Svg Icon | path: assets/media/icons/duotune/files/fil002.svg-->
                                                <span class="svg-icon svg-icon-primary svg-icon-2hx">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="21" viewBox="0 0 20 21" fill="none">
                                                        <path opacity="0.3" d="M19 3.40002C18.4 3.40002 18 3.80002 18 4.40002V8.40002H14V4.40002C14 3.80002 13.6 3.40002 13 3.40002C12.4 3.40002 12 3.80002 12 4.40002V8.40002H8V4.40002C8 3.80002 7.6 3.40002 7 3.40002C6.4 3.40002 6 3.80002 6 4.40002V8.40002H2V4.40002C2 3.80002 1.6 3.40002 1 3.40002C0.4 3.40002 0 3.80002 0 4.40002V19.4C0 20 0.4 20.4 1 20.4H19C19.6 20.4 20 20 20 19.4V4.40002C20 3.80002 19.6 3.40002 19 3.40002ZM18 10.4V13.4H14V10.4H18ZM12 10.4V13.4H8V10.4H12ZM12 15.4V18.4H8V15.4H12ZM6 10.4V13.4H2V10.4H6ZM2 15.4H6V18.4H2V15.4ZM14 18.4V15.4H18V18.4H14Z" fill="black" />
                                                        <path d="M19 0.400024H1C0.4 0.400024 0 0.800024 0 1.40002V4.40002C0 5.00002 0.4 5.40002 1 5.40002H19C19.6 5.40002 20 5.00002 20 4.40002V1.40002C20 0.800024 19.6 0.400024 19 0.400024Z" fill="black" />
                                                    </svg>
                                                </span>
                                                <!--end::Svg Icon-->
                                                <!--end::Svg Icon-->
                                            </div>
                                        </div>
                                        <!--end::Symbol-->
                                        <!--begin::Title-->
                                        <div>
                                            <div class="fs-2 fw-bolder" data-kt-countup="true" data-kt-countup-value="@Model.Histories.ToList().Count()">0</div>
                                            <div class="fw-bold fs-6">Events</div>
                                        </div>
                                        <!--end::Title-->
                                    </div>
                                    <!--end::History-->
                                </div>
                                <!--end::Stats-->
                            </div>
                            <!--end::Wrapper-->
                        </div>
                        <!--end::Stats-->
                    </div>
                    <!--end::Info-->
                </div>
                <!--end::Details-->
                <!--</div>-->
            </div>
        </div>
        <!--end::Navbar-->
        <!--begin::Row-->
        <div class="row g-5 g-xxl-8">

            <!--begin::Col-->
            <div class="col-xl-6">

                <!--begin::Users Widget 9-->
                <div class="card mb-5 mb-xl-8">
                    <!--begin::Body-->
                    <div class="card-body pb-0">
                        <!--begin::Header-->
                        <div class="d-flex mb-5">
                            <!--begin::User-->
                            <div class="d-flex flex-grow-1">
                                <!--begin::Avatar-->
                                <div class="symbol symbol-40px me-3">
                                    <div class="symbol-label bg-primary bg-opacity-10">
                                        <!--begin::Svg Icon | path: icons/duotune/abstract/abs045.svg-->
                                        <span class="svg-icon svg-icon-1 svg-icon-primary">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                                                <path opacity="0.3" d="M22 12C22 17.5 17.5 22 12 22C6.5 22 2 17.5 2 12C2 6.5 6.5 2 12 2C17.5 2 22 6.5 22 12ZM12 7C10.3 7 9 8.3 9 10C9 11.7 10.3 13 12 13C13.7 13 15 11.7 15 10C15 8.3 13.7 7 12 7Z" fill="black" />
                                                <path d="M12 22C14.6 22 17 21 18.7 19.4C17.9 16.9 15.2 15 12 15C8.8 15 6.09999 16.9 5.29999 19.4C6.99999 21 9.4 22 12 22Z" fill="black" />
                                            </svg>
                                        </span>
                                        <!--end::Svg Icon-->
                                    </div>
                                </div>
                                <!--end::Avatar-->
                                <!--begin::Info-->
                                <div class="d-flex flex-column">
                                    <a class="text-gray-900 text-hover-primary fs-6 fw-bolder">Development Team</a>
                                    <span class="fw-bold text-muted">Submitter, Developer, & P.M.</span>
                                </div>
                                <!--end::Info-->
                            </div>
                            <!--end::User-->
                        </div>
                    </div>
                    <!--end::Header-->
                    <!--begin::Body-->
                    <div class="card-body pt-5">

                        <!--begin::Item-->
                        <div class="d-flex mb-5">
                            <!--begin::Symbol-->
                            <div class="symbol symbol-60px symbol-2by3 flex-shrink-0 me-4">
                                <img src="/assets/media/stock/600x400/img-3.jpg" class="mw-60" alt="" />
                            </div>
                            <!--end::Symbol-->
                            <!--begin::Section-->
                            <div class="d-flex align-items-center flex-wrap flex-grow-1 mt-n2 mt-lg-n1">
                                <!--begin::Title-->
                                <div class="row">
                                    <div class="col-12">
                                        <div class="d-flex flex-column flex-grow-1 my-lg-0 my-2 pe-3">
                                            <a href="#" class="fs-5 text-hover-primary fw-bolder text-muted">Submitter</a>
                                            @*<span class="text-gray-400 fw-bold fs-7 my-1">User Role</span>*@
                                        </div>
                                    </div>
                                    <div class="py-lg-0 py-2">
                                        <span class="text-gray-800 fw-boldest fs-3">@Model.OwnerUser.FullName</span>
                                        @*<span class="text-gray-400 fs-7 fw-bold d-block">Actions on this ticket</span>*@
                                    </div>
                                </div>
                                <!--end::Title-->
                            </div>
                            <!--end::Section-->
                        </div>
                        <!--end::Item-->
                        <!--begin::Item-->
                        <div class="d-flex mb-5">
                            <!--begin::Symbol-->
                            <div class="symbol symbol-60px symbol-2by3 flex-shrink-0 me-4">
                                <img src="/assets/media/stock/600x400/img-3.jpg" class="mw-100" alt="" />
                            </div>
                            <!--end::Symbol-->
                            <!--begin::Section-->
                            <div class="d-flex align-items-center flex-wrap flex-grow-1 mt-n2 mt-lg-n1">
                                <!--begin::Title-->
                                <div class="row">
                                    <div class="col-12">

                                        <div class="d-flex flex-column flex-grow-1 my-lg-0 my-2 pe-3">
                                            <a href="#" class="fs-5 text-hover-primary fw-bolder text-muted" >Developer</a>
                                            @*<span class="text-gray-400 fw-bold fs-7 my-1">User Role</span>*@
                                        </div>
                                    </div>
                                    <div class="py-lg-0 py-2">
                                        @if (Model.DeveloperUser != null)
                                        {
                                            <span class="text-gray-800 fw-boldest fs-3">@Model.DeveloperUser.FullName</span>
                                        }
                                        else
                                        {
                                            <span class="text-gray-800 fw-boldest fs-3">Currently Unassigned</span>
                                        }
                                        @*<span class="text-gray-400 fs-7 fw-bold d-block">Actions on this ticket</span>*@
                                    </div>
                                </div>
                                <!--end::Title-->
                            </div>
                            <!--end::Section-->
                        </div>
                        <!--end::Item-->
                        <!--begin::Item-->
                        <div class="d-flex mb-5">
                            <!--begin::Symbol-->
                            <div class="symbol symbol-60px symbol-2by3 flex-shrink-0 me-4">
                                <img src="/assets/media/stock/600x400/img-3.jpg" class="mw-100" alt="" />
                            </div>
                            <!--end::Symbol-->
                            <!--begin::Section-->
                            <div class="d-flex align-items-center flex-wrap flex-grow-1 mt-n2 mt-lg-n1">
                                <!--begin::Title-->
                                <div class="row">
                                    <div class="col-12">

                                        <div class="d-flex flex-column flex-grow-1 my-lg-0 my-2 pe-3">
                                            <a href="#" class="fs-5 text-hover-primary fw-bolder text-muted">Project Manager</a>
                                            @*<span class="text-gray-400 fw-bold fs-7 my-1">User Role</span>*@
                                        </div>
                                    </div>
                                    <div class="py-lg-0 py-2">
                                        @if (projectManager != null)
                                        {
                                            <span class="text-gray-800 fw-boldest fs-3">@projectManager.FullName</span>
                                        }
                                        else
                                        {
                                            <span class="text-gray-800 fw-boldest fs-3">Currently Unassigned</span>
                                        }
                                        @*<span class="text-gray-400 fs-7 fw-bold d-block">Actions on this ticket</span>*@
                                    </div>
                                </div>
                                <!--end::Title-->

                            </div>
                            <!--end::Section-->
                        </div>
                        <!--end::Item-->

                    </div>
                    <!--end::Body-->
                </div>
                <!--end::Users Widget 9-->

                <!--begin::Comments Widget 1-->
                <div class="card mb-5 mb-xl-8">
                    <!--begin::Body-->
                    <div class="card-body pb-0">
                        <!--begin::Header-->
                        <div class="d-flex mb-5">
                            <!--begin::User-->
                            <div class="d-flex align-items-center flex-grow-1">
                                <!--begin::Avatar-->
                                <div class="symbol symbol-40px me-3">
                                    <div class="symbol-label bg-primary bg-opacity-10">
                                        <!--begin::Svg Icon | path: icons/duotune/abstract/abs045.svg-->
                                        <span class="svg-icon svg-icon-1 svg-icon-primary">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                                                <path opacity="0.3" d="M8 8C8 7.4 8.4 7 9 7H16V3C16 2.4 15.6 2 15 2H3C2.4 2 2 2.4 2 3V13C2 13.6 2.4 14 3 14H5V16.1C5 16.8 5.79999 17.1 6.29999 16.6L8 14.9V8Z" fill="black" />
                                                <path d="M22 8V18C22 18.6 21.6 19 21 19H19V21.1C19 21.8 18.2 22.1 17.7 21.6L15 18.9H9C8.4 18.9 8 18.5 8 17.9V7.90002C8 7.30002 8.4 6.90002 9 6.90002H21C21.6 7.00002 22 7.4 22 8ZM19 11C19 10.4 18.6 10 18 10H12C11.4 10 11 10.4 11 11C11 11.6 11.4 12 12 12H18C18.6 12 19 11.6 19 11ZM17 15C17 14.4 16.6 14 16 14H12C11.4 14 11 14.4 11 15C11 15.6 11.4 16 12 16H16C16.6 16 17 15.6 17 15Z" fill="black" />
                                            </svg>
                                        </span>
                                        <!--end::Svg Icon-->
                                    </div>
                                </div>
                                <!--end::Avatar-->
                                <!--begin::Info-->
                                <div class="d-flex flex-column">
                                    <a class="text-gray-900 text-hover-primary fs-6 fw-bolder">Notes, Comments & Discussion</a>
                                    <span class="fw-bold text-muted">All comments related to the current Ticket</span>
                                </div>
                                <!--end::Info-->
                            </div>
                            <!--end::User-->
                        </div>
                        <!--end::Header-->
                        <!--begin::Card body-->
                        <div class="card-body p-9 pt-3 pb-3">
                            <!--begin::Files-->
                            @foreach (var comment in Model.Comments)
                            {
                                <!--begin::Header-->
                                <div class="d-flex align-items-center mb-3">
                                    <!--begin::User-->
                                    <div class="d-flex align-items-center flex-grow-1">
                                        <!--begin::Avatar-->
                                        <div class="symbol symbol-45px me-5">
                                            <img src="/assets/media/avatars/150-10.jpg" alt="" />
                                        </div>
                                        <!--end::Avatar-->
                                        <!--begin::Info-->
                                        <div class="d-flex flex-column">
                                            <a href="#" class="text-gray-900 text-hover-primary fs-6 fw-bolder">@comment.User.FullName</a>
                                            <span class="text-gray-400 fw-bold">@comment.Created.ToString("dd/MM/yy")</span>
                                        </div>
                                        <!--end::Info-->
                                    </div>
                                    <!--end::User-->
                                </div>
                                <!--end::Header-->
                                <!--begin::Post-->
                                <div class="mb-7">
                                    <!--begin::Text-->
                                    <div class="text-gray-800 mb-5"> @comment.Comment</div>
                                    <!--end::Text-->
                                </div>
                                <!--end::Post-->
                            }
                            <!--end::Files-->
                        </div>
                        <!--end::Card body -->
                        <form asp-action="Create" asp-controller="TicketComments" method="post">
                            <input hidden asp-for="Id" name="TicketId" />
                            @*<label asp-for="Comments" class="control-label"></label>*@
                            <textarea name="Comment" id="Comments" class="form-control mb-3"></textarea>
                            <span asp-validation-for="Comments" class="text-danger"></span>
                            <button class="btn btn-primary btn-sm mb-9 mt-3" style="display:block; width:100%" type="submit">Comment</button>
                        </form>
                    </div>
                </div>
                <!--end::Comments Widget 1-->

            </div>
            <!--end::Col-->

            <!--begin::Col-->
            <div class="col-xl-6">

                <!--begin::Attachments Widget 2-->
                <div class="card mb-5 mb-xl-8">
                    <!--begin::Body-->
                    <div class="card-body pb-0">
                        <!--begin::Header-->
                        <div class="d-flex mb-5">
                            <!--begin::User-->
                            <div class="d-flex align-items-center flex-grow-1">
                                <!--begin::Avatar-->
                                <div class="symbol symbol-40px me-3">
                                    <div class="symbol-label bg-primary bg-opacity-10">
                                        <!--begin::Svg Icon | path: icons/duotune/abstract/abs045.svg-->
                                        <span class="svg-icon svg-icon-1 svg-icon-primary">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                                                <path opacity="0.3" d="M4.425 20.525C2.525 18.625 2.525 15.525 4.425 13.525L14.825 3.125C16.325 1.625 18.825 1.625 20.425 3.125C20.825 3.525 20.825 4.12502 20.425 4.52502C20.025 4.92502 19.425 4.92502 19.025 4.52502C18.225 3.72502 17.025 3.72502 16.225 4.52502L5.82499 14.925C4.62499 16.125 4.62499 17.925 5.82499 19.125C7.02499 20.325 8.82501 20.325 10.025 19.125L18.425 10.725C18.825 10.325 19.425 10.325 19.825 10.725C20.225 11.125 20.225 11.725 19.825 12.125L11.425 20.525C9.525 22.425 6.425 22.425 4.425 20.525Z" fill="black" />
                                                <path d="M9.32499 15.625C8.12499 14.425 8.12499 12.625 9.32499 11.425L14.225 6.52498C14.625 6.12498 15.225 6.12498 15.625 6.52498C16.025 6.92498 16.025 7.525 15.625 7.925L10.725 12.8249C10.325 13.2249 10.325 13.8249 10.725 14.2249C11.125 14.6249 11.725 14.6249 12.125 14.2249L19.125 7.22493C19.525 6.82493 19.725 6.425 19.725 5.925C19.725 5.325 19.525 4.825 19.125 4.425C18.725 4.025 18.725 3.42498 19.125 3.02498C19.525 2.62498 20.125 2.62498 20.525 3.02498C21.325 3.82498 21.725 4.825 21.725 5.925C21.725 6.925 21.325 7.82498 20.525 8.52498L13.525 15.525C12.325 16.725 10.525 16.725 9.32499 15.625Z" fill="black" />
                                            </svg>
                                        </span>
                                        <!--end::Svg Icon-->
                                    </div>
                                </div>
                                <!--end::Avatar-->
                                <!--begin::Info-->
                                <div class="d-flex flex-column">
                                    <a class="text-gray-900 text-hover-primary fs-6 fw-bolder">Attached Files</a>
                                    <span class="fw-bold text-muted">.jpg  .png  .pdf  .doc  .docx  .xls  .xlsx</span>
                                </div>
                                <!--end::Info-->
                            </div>
                            <!--end::User-->
                        </div>
                        <!--end::Header-->
                        <!--begin::Card body-->
                        <div class="card-body p-9 pt-3 pb-3">
                            <!--begin::Files-->
                            <div class="d-flex flex-column">
                                @foreach (TicketAttachment item in Model.Attachments)
                                {
                                    <!--begin::File-->
                                    <div class="d-flex align-items-center mb-5">
                                        <!--begin::Icon-->
                                        <div class="symbol symbol-30px me-5">
                                            <img alt="Icon" src="@BTFileService.GetFileIcon(item.FileName)" />
                                        </div>
                                        <!--end::Icon-->
                                        <!--begin::Details-->
                                        <div class="fw-bold">
                                            <a class="fs-6 fw-bolder text-dark text-hover-primary">File Name: @System.IO.Path.GetFileNameWithoutExtension(item.FileName)</a>
                                            <div class="text-gray-400">
                                                @item.Created.ToString("dd/MM/yy")
                                                @*<a href="#">@item.</a>*@
                                            </div>
                                        </div>
                                        <!--end::Details-->
                                    </div>
                                    <!--end::File-->
                                }
                            </div>
                            <!--end::Files-->
                        </div>
                        <!--begin::Notice-->
                        <form asp-action="Create" asp-controller="TicketAttachments" enctype="multipart/form-data" method="post">
                            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                            <input type="hidden" asp-for="@Model.Id" name="TicketId">
                            <div class="notice d-flex bg-light-primary rounded border-primary border border-dashed p-8 mb-9">
                                <!--begin::Icon-->
                                <!--begin::Svg Icon | path: svg/files/upload.svg-->
                                <span class="svg-icon svg-icon-3hx svg-icon-primary me-4">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="67" height="67" viewBox="0 0 67 67" fill="none">
                                        <path opacity="0.25" d="M8.375 11.167C8.375 6.54161 12.1246 2.79199 16.75 2.79199H43.9893C46.2105 2.79199 48.3407 3.67436 49.9113 5.24497L56.172 11.5057C57.7426 13.0763 58.625 15.2065 58.625 17.4277V55.8337C58.625 60.459 54.8754 64.2087 50.25 64.2087H16.75C12.1246 64.2087 8.375 60.459 8.375 55.8337V11.167Z" fill="#00A3FF" />
                                        <path d="M41.875 5.28162C41.875 3.90663 42.9896 2.79199 44.3646 2.79199V2.79199C46.3455 2.79199 48.2452 3.57889 49.6459 4.97957L56.4374 11.7711C57.8381 13.1718 58.625 15.0715 58.625 17.0524V17.0524C58.625 18.4274 57.5104 19.542 56.1354 19.542H44.6667C43.1249 19.542 41.875 18.2921 41.875 16.7503V5.28162Z" fill="#00A3FF" />
                                        <path d="M32.4311 25.3368C32.1018 25.4731 31.7933 25.675 31.5257 25.9427L23.1507 34.3177C22.0605 35.4079 22.0605 37.1755 23.1507 38.2657C24.2409 39.3559 26.0085 39.3559 27.0987 38.2657L30.708 34.6563V47.4583C30.708 49.0001 31.9579 50.25 33.4997 50.25C35.0415 50.25 36.2913 49.0001 36.2913 47.4583V34.6563L39.9007 38.2657C40.9909 39.3559 42.7585 39.3559 43.8487 38.2657C44.9389 37.1755 44.9389 35.4079 43.8487 34.3177L35.4737 25.9427C34.6511 25.1201 33.443 24.9182 32.4311 25.3368Z" fill="#00A3FF" />
                                    </svg>
                                </span>
                                <!--end::Svg Icon-->
                                <!--end::Icon-->
                                <!--begin::Wrapper-->
                                <div class="row d-flex justify-content-center">
                                    <!--begin::Content-->
                                    <div class="col-12 fw-bold">
                                        <h4 class="text-gray-900 fw-bolder">Quick File Uploader</h4>
                                    </div>
                                    <div class="col-12 mb-2">
                                        <label>
                                            <input asp-for="@Model.Attachments.FirstOrDefault().Description" type="text" placeholder="File Description" class="form-control" />
                                        </label>
                                    </div>
                                    <!--end::Content-->
                                    <input class="mb-2" asp-for="@Model.Attachments.FirstOrDefault().FormFile" type="file" size="10" />
                                    <button type="submit" class="btn btn-primary btn-sm">Upload File</button>
                                </div>
                                <!--end::Wrapper-->
                            </div>
                        </form>
                        <!--end::Notice-->
                        <!--end::Card body -->
                    </div>
                </div>
                <!--end::Attachments Widget 2-->

                <!--begin::History Widget 5-->
                <div class="card mb-5 mb-xl-8">
                    <!--begin::Timeline-->
                    <div class="card-body pb-0">
                        <!--begin::Card head-->
                        <div class="d-flex mb-5">
                            <!--begin::Title-->
                            <div class="d-flex align-items-center flex-grow-1">
                                <!--begin::Avatar-->
                                <div class="symbol symbol-40px me-3">
                                    <div class="symbol-label bg-primary bg-opacity-10">
                                        <!--begin::Svg Icon | path: assets/media/icons/duotune/files/fil002.svg-->
                                        <span class="svg-icon svg-icon-1 svg-icon-primary">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="21" viewBox="0 0 20 21" fill="none">
                                                <path opacity="0.3" d="M19 3.40002C18.4 3.40002 18 3.80002 18 4.40002V8.40002H14V4.40002C14 3.80002 13.6 3.40002 13 3.40002C12.4 3.40002 12 3.80002 12 4.40002V8.40002H8V4.40002C8 3.80002 7.6 3.40002 7 3.40002C6.4 3.40002 6 3.80002 6 4.40002V8.40002H2V4.40002C2 3.80002 1.6 3.40002 1 3.40002C0.4 3.40002 0 3.80002 0 4.40002V19.4C0 20 0.4 20.4 1 20.4H19C19.6 20.4 20 20 20 19.4V4.40002C20 3.80002 19.6 3.40002 19 3.40002ZM18 10.4V13.4H14V10.4H18ZM12 10.4V13.4H8V10.4H12ZM12 15.4V18.4H8V15.4H12ZM6 10.4V13.4H2V10.4H6ZM2 15.4H6V18.4H2V15.4ZM14 18.4V15.4H18V18.4H14Z" fill="black" />
                                                <path d="M19 0.400024H1C0.4 0.400024 0 0.800024 0 1.40002V4.40002C0 5.00002 0.4 5.40002 1 5.40002H19C19.6 5.40002 20 5.00002 20 4.40002V1.40002C20 0.800024 19.6 0.400024 19 0.400024Z" fill="black" />
                                            </svg>
                                        </span>
                                        <!--end::Svg Icon-->
                                        <!--end::Svg Icon-->
                                    </div>
                                </div>
                                <!--end::Avatar-->
                                <!--begin::Info-->
                                <div class="d-flex flex-column">
                                    <a class="text-gray-900 text-hover-primary fs-6 fw-bolder">Event History</a>
                                    <span class="fw-bold text-muted">Complete history of changes to ticket </span>
                                </div>
                                <!--end::Info-->
                            </div>
                            <!--end::Title-->
                        </div>
                        <!--end::Card head-->
                        <!--begin::Card body-->
                        <div class="card-body">
                            <!--begin::Tab Content-->
                            <div class="tab-content">
                                <!--begin::Tab panel-->
                                <div id="kt_activity_today" class="card-body p-0 tab-pane fade show active" role="tabpanel" aria-labelledby="kt_activity_today_tab">
                                    <!--begin::Timeline-->
                                    <div class="timeline">
                                        @foreach (TicketHistory ticketHistory in Model.Histories.OrderByDescending(h => h.Created))
                                        {
                                            <!--begin::Timeline item-->
                                            <div class="timeline-item">
                                                <!--begin::Timeline line-->
                                                <div class="timeline-line w-40px"></div>
                                                <!--end::Timeline line-->
                                                <!--begin::Timeline icon-->
                                                <div class="timeline-icon symbol symbol-circle symbol-40px">
                                                    <div class="symbol-label bg-light">
                                                        <!--begin::Svg Icon | path: icons/duotune/communication/com009.svg-->
                                                        <span class="svg-icon svg-icon-2 svg-icon-gray-500">
                                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                                                                <path opacity="0.3" d="M5.78001 21.115L3.28001 21.949C3.10897 22.0059 2.92548 22.0141 2.75004 21.9727C2.57461 21.9312 2.41416 21.8418 2.28669 21.7144C2.15923 21.5869 2.06975 21.4264 2.0283 21.251C1.98685 21.0755 1.99507 20.892 2.05201 20.7209L2.886 18.2209L7.22801 13.879L10.128 16.774L5.78001 21.115Z" fill="black" />
                                                                <path d="M21.7 8.08899L15.911 2.30005C15.8161 2.2049 15.7033 2.12939 15.5792 2.07788C15.455 2.02637 15.3219 1.99988 15.1875 1.99988C15.0531 1.99988 14.92 2.02637 14.7958 2.07788C14.6717 2.12939 14.5589 2.2049 14.464 2.30005L13.74 3.02295C13.548 3.21498 13.4402 3.4754 13.4402 3.74695C13.4402 4.01849 13.548 4.27892 13.74 4.47095L14.464 5.19397L11.303 8.35498C10.1615 7.80702 8.87825 7.62639 7.62985 7.83789C6.38145 8.04939 5.2293 8.64265 4.332 9.53601C4.14026 9.72817 4.03256 9.98855 4.03256 10.26C4.03256 10.5315 4.14026 10.7918 4.332 10.984L13.016 19.667C13.208 19.859 13.4684 19.9668 13.74 19.9668C14.0115 19.9668 14.272 19.859 14.464 19.667C15.3575 18.77 15.9509 17.618 16.1624 16.3698C16.374 15.1215 16.1932 13.8383 15.645 12.697L18.806 9.53601L19.529 10.26C19.721 10.452 19.9814 10.5598 20.253 10.5598C20.5245 10.5598 20.785 10.452 20.977 10.26L21.7 9.53601C21.7952 9.44108 21.8706 9.32825 21.9221 9.2041C21.9737 9.07995 22.0002 8.94691 22.0002 8.8125C22.0002 8.67809 21.9737 8.54505 21.9221 8.4209C21.8706 8.29675 21.7952 8.18392 21.7 8.08899Z" fill="black" />
                                                            </svg>
                                                        </span>
                                                        <!--end::Svg Icon-->
                                                    </div>
                                                </div>
                                                <!--end::Timeline icon-->
                                                <!--begin::Timeline content-->
                                                <div class="timeline-content mb-10 mt-n2">
                                                    <!--begin::Timeline heading-->
                                                    <div class="overflow-auto pe-3">
                                                        <!--begin::Title-->
                                                        <div class="fs-5 fw-boldest mb-2">@ticketHistory.Description</div>
                                                        <span class="fw-bolder text-gray-800 fs-8 ps-3">Previous @ticketHistory.Property: "@ticketHistory.OldValue"</span>
                                                        <br />
                                                        <span class="text-muted fs-8 ps-3">@ticketHistory.Created.ToString("MM/dd") - @ticketHistory.User.FullName</span>

                                                        <!--end::Description-->
                                                    </div>
                                                    <!--end::Timeline heading-->
                                                </div>
                                                <!--end::Timeline content-->
                                            </div>
                                            <!--end::Timeline item-->
                                        }
                                    </div>
                                    <!--end::Timeline-->
                                </div>
                                <!--end::Tab panel-->
                            </div>
                            <!--end::Tab Content-->
                        </div>
                        <!--end::Card body-->
                    </div>
                    <!--end:Timeline-->
                </div>
                <!--end::History Widget 5-->

            </div>
            <!--end::Col-->
        </div>
        <!--end::Row-->
    </div>
    <!--end::Container-->
</div>
<!--end::Content-->

@section Scripts
{
    <script>
        $('#Comments').summernote({
            toolbar: [
                ['style', ['style']],
                ['font', ['bold', 'underline', 'clear']],
                ['fontname', ['fontname']],
                ['color', ['color']],
                ['para', ['ul', 'ol', 'paragraph']],
                ['insert', ['link']],
                ['view', ['fullscreen', 'codeview', 'help']]
            ],
            height: 200,
            focus: true,
            placeholder: 'Add comment *'
        });
    </script>
}


